# Compute Lab 180: Configuring a VPC

## Overview
In this lab, I created a custom Virtual Private Cloud (VPC) and configured all of the networking components needed to securely deploy EC2 instances. I created both public and private subnets, attached and configured an internet gateway and NAT gateway, set up route tables for each subnet, launched a bastion host in the public subnet, and tested connectivity from a private instance through the bastion host and NAT gateway.

## Objectives
- Create a VPC with a private and public subnet, an internet gateway, and a NAT gateway.  
- Configure route tables associated with subnets to handle local and internet-bound traffic.  
- Launch a bastion server in a public subnet.  
- Use the bastion server to log in to an instance in a private subnet.  
- (Optional) Launch a private EC2 instance and test outbound internet connectivity through the NAT gateway.  

## AWS Services Used
- **Amazon VPC** (VPC, subnets, route tables)  
- **Internet Gateway**  
- **NAT Gateway**  
- **Amazon EC2** (bastion server and private instance)  
- **Elastic IP**  
- **Security Groups**  

## Pre-requisites
- AWS Management Console access provided through lab credentials.  
- Lab environment launched and ready with "Lab status: ready".  
- Basic knowledge of CIDR blocks, routing, and EC2 connectivity.  

## Steps Taken

### Task 1: Creating a VPC
1. In the AWS Management Console, searched for **VPC** and navigated to the VPC Management Console.  
2. Selected **Your VPCs**, then chose **Create VPC**.  
3. Configured the following:  
   - **Resources to create**: VPC only  
   - **Name tag**: `Lab VPC`  
   - **IPv4 CIDR block**: `10.0.0.0/16` (manual input)  
   - **IPv6 CIDR block**: No IPv6 CIDR block  
   - **Tenancy**: Default  
   - **Tags**: left defaults  
4. Chose **Create VPC**. Confirmation message appeared.  
5. Selected the new VPC → **Actions** → **Edit VPC settings**.  
6. Under **DNS settings**, enabled **DNS hostnames**, then saved.  
   - This ensures EC2 instances launched in this VPC automatically receive a public DNS name.  

### Task 2: Creating Subnets

#### Task 2.1: Creating a Public Subnet
1. Navigated to **Subnets** → **Create subnet**.  
2. Configured:  
   - **VPC ID**: `Lab VPC`  
   - **Subnet name**: `Public Subnet`  
   - **Availability Zone**: First in the list (not "No preference")  
   - **IPv4 CIDR block**: `10.0.0.0/24`  
3. Chose **Create subnet**.  
4. Selected the new subnet → **Actions** → **Edit subnet settings**.  
5. Under **Auto-assign IP settings**, enabled **Auto-assign public IPv4 address**.  
   - At this point, although it is called *Public Subnet*, it was not yet public since no internet gateway was attached.  

#### Task 2.2: Creating a Private Subnet
1. Repeated the same subnet creation steps with these options:  
   - **VPC ID**: `Lab VPC`  
   - **Subnet name**: `Private Subnet`  
   - **Availability Zone**: Same AZ as Public Subnet  
   - **IPv4 CIDR block**: `10.0.2.0/23`  
2. Chose **Create subnet**.  
   - This range (`10.0.2.0/23`) covers both `10.0.2.x` and `10.0.3.x`, making it twice the size of the public subnet.  

### Task 3: Creating an Internet Gateway
1. Navigated to **Internet Gateways** → **Create internet gateway**.  
2. Entered **Name tag**: `Lab IGW`.  
3. Chose **Create internet gateway**.  
4. Selected the new IGW → **Actions** → **Attach to VPC** → chose `Lab VPC`.  
   - Public subnet now had potential internet connectivity (once routes were configured).  

### Task 4: Configuring Route Tables

1. Navigated to **Route tables**.  
2. Located the route table already associated with `Lab VPC`.  
3. Renamed it to **Private Route Table**.  
   - It contained only the local route (`10.0.0.0/16` → local).  
4. Chose **Create route table**, and configured:  
   - **Name**: `Public Route Table`  
   - **VPC**: `Lab VPC`  
5. After creation, edited routes:  
   - Added route `0.0.0.0/0` → **Internet Gateway (Lab IGW)**.  
6. Saved changes.  
7. Under **Subnet associations**, associated **Public Subnet** with **Public Route Table**.  
   - At this point, the Public Subnet became truly public.  

### Task 5: Launching a Bastion Server
1. In the AWS Management Console, searched for **EC2**.  
2. Chose **Launch instances** and configured:  
   - **Name**: `Bastion Server`  
   - **AMI**: Amazon Linux 2023  
   - **Instance type**: `t3.micro`  
   - **Key pair**: Proceed without a key pair (used EC2 Instance Connect)  
   - **Network settings** → Edit:  
     - **VPC**: Lab VPC  
     - **Subnet**: Public Subnet  
     - **Auto-assign public IP**: Enable  
     - **Security group**: New, named `Bastion Security Group` with:  
       - **Inbound rule**: SSH, Source = Anywhere  
3. Chose **Launch instance**, then **View all instances**.  
   - Instance state changed from **Pending** → **Running**.  

### Task 6: Creating a NAT Gateway
1. In the AWS Management Console, searched for **NAT Gateways**.  
2. Chose **Create NAT Gateway**.  
   - **Name**: `Lab NAT gateway`  
   - **Subnet**: Public Subnet  
   - **Elastic IP**: Allocated new Elastic IP  
3. Chose **Create NAT gateway**.  
4. Navigated to **Route tables**, selected **Private Route Table**.  
5. Chose **Edit routes**, added:  
   - **Destination**: `0.0.0.0/0`  
   - **Target**: NAT Gateway → `Lab NAT gateway`  
6. Saved changes.  
   - Now, private subnet resources could reach the internet via NAT gateway.  

## Cleanup
To avoid ongoing charges, I performed the following cleanup steps:
- Terminated the Bastion Server and Private Instance EC2 instances.
- Released the Elastic IP address allocated to the NAT Gateway.
- Deleted the NAT Gateway.
- Detached and deleted the Internet Gateway (Lab IGW).
- Deleted the Public Route Table and Private Route Table.
- Deleted the Public Subnet and Private Subnet.
- Deleted the Lab VPC itself.

## Wrap-up
In this lab, I successfully:
- Created a VPC with both public and private subnets.
- Configured internet access using an Internet Gateway and a NAT Gateway.
- Built and associated route tables for proper routing.
-Practiced proper cleanup to remove all resources and avoid unnecessary costs.